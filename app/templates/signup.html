{% extends "base.html" %}

{% block title %}{{ t.nav_signup }} - SmartCrop{% endblock %}

{% block content %}
<div class="signup-page py-5">
    <div class="container">
        <div class="row justify-content-center align-items-center min-vh-75">
            <div class="col-lg-10">
                <div class="row g-0 shadow-lg rounded-4 overflow-hidden">
                    <!-- Left side - Form -->
                    <div class="col-md-6 bg-white p-5">
                        <div class="text-center mb-4">
                            <h3 class="fw-bold text-dark">
                                <i class="fas fa-user-plus text-success me-2"></i>{{ t.signup_title }}
                            </h3>
                            <p class="text-muted">{{ t.signup_subtitle }}</p>
                        </div>
                        
                        <form method="POST" action="{{ url_for('signup') }}" id="signupForm">
                            <div class="row g-3">
                                <div class="col-12">
                                    <label for="username" class="form-label fw-semibold text-dark">
                                        <i class="fas fa-user text-success me-2"></i>{{ t.signup_username }}
                                    </label>
                                    <input type="text" class="form-control form-control-lg" id="username" name="username" 
                                           required minlength="3" maxlength="20" pattern="[a-zA-Z0-9_]+"
                                           placeholder="{{ t.signup_username }}">
                                    <small class="text-muted">3-20 characters</small>
                                </div>
                                
                                <div class="col-12">
                                    <label for="email" class="form-label fw-semibold text-dark">
                                        <i class="fas fa-envelope text-success me-2"></i>{{ t.signup_email }}
                                    </label>
                                    <input type="email" class="form-control form-control-lg" id="email" name="email" 
                                           required placeholder="your@email.com">
                                </div>
                                
                                <div class="col-12">
                                    <label for="password" class="form-label fw-semibold text-dark">
                                        <i class="fas fa-lock text-success me-2"></i>{{ t.signup_password }}
                                    </label>
                                    <div class="input-group">
                                        <input type="password" class="form-control form-control-lg" id="password" name="password" 
                                               required minlength="8" placeholder="Min. 8 characters">
                                        <button class="btn btn-outline-secondary toggle-password" type="button">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                    <!-- Password strength indicator -->
                                    <div class="mt-2">
                                        <div class="progress" style="height: 5px;">
                                            <div class="progress-bar" id="passwordStrength" role="progressbar"></div>
                                        </div>
                                        <small id="passwordFeedback" class="text-muted">{{ t.signup_password_strength }}</small>
                                    </div>
                                </div>
                                
                                <div class="col-12">
                                    <label for="confirm_password" class="form-label fw-semibold text-dark">
                                        <i class="fas fa-check-double text-success me-2"></i>{{ t.signup_confirm }}
                                    </label>
                                    <div class="input-group">
                                        <input type="password" class="form-control form-control-lg" id="confirm_password" 
                                               name="confirm_password" required placeholder="{{ t.signup_confirm }}">
                                        <button class="btn btn-outline-secondary toggle-password" type="button">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                    <small id="confirmFeedback" class="text-muted"></small>
                                </div>
                                
                                <div class="col-12">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="termsCheck" required>
                                        <label class="form-check-label text-dark" for="termsCheck">
                                            I accept the <a href="#" class="text-success fw-semibold" data-bs-toggle="modal" data-bs-target="#termsModal">terms and conditions</a>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-success btn-lg w-100 py-3 mt-4" id="signupBtn">
                                <i class="fas fa-user-plus me-2"></i>{{ t.signup_button }}
                            </button>
                            
                            <div class="text-center mt-4">
                                <p class="text-muted mb-0">
                                    {{ t.signup_have_account }}
                                    <a href="{{ url_for('login') }}" class="text-success fw-semibold">{{ t.signup_login }}</a>
                                </p>
                            </div>
                        </form>
                    </div>
                    
                    <!-- Right side - Illustration -->
                    <div class="col-md-6 d-none d-md-block p-5" 
                         style="background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);">
                        <div class="d-flex flex-column justify-content-center h-100">
                            <div class="text-center mb-4" style="color: #fff;">
                                <i class="fas fa-seedling fa-5x mb-3"></i>
                                <h2 class="fw-bold">SmartCrop</h2>
                                <p class="lead">{{ t.hero_subtitle }}</p>
                            </div>
                            
                            <div class="mt-4">
                                <div class="rounded-3 p-4 mb-3" style="background: rgba(255,255,255,0.15); backdrop-filter: blur(5px);">
                                    <div class="d-flex align-items-center">
                                        <div class="bg-white rounded-circle p-3 me-3">
                                            <i class="fas fa-brain text-success fa-lg"></i>
                                        </div>
                                        <div>
                                            <h6 class="mb-1 fw-bold" style="color: #fff;">{{ t.feature_ai_title }}</h6>
                                            <small style="color: rgba(255,255,255,0.9);">{{ t.feature_ai_desc }}</small>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="rounded-3 p-4 mb-3" style="background: rgba(255,255,255,0.15); backdrop-filter: blur(5px);">
                                    <div class="d-flex align-items-center">
                                        <div class="bg-white rounded-circle p-3 me-3">
                                            <i class="fas fa-chart-bar text-success fa-lg"></i>
                                        </div>
                                        <div>
                                            <h6 class="mb-1 fw-bold" style="color: #fff;">{{ t.nav_dashboard }}</h6>
                                            <small style="color: rgba(255,255,255,0.9);">{{ t.feature_accurate_desc }}</small>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="rounded-3 p-4" style="background: rgba(255,255,255,0.15); backdrop-filter: blur(5px);">
                                    <div class="d-flex align-items-center">
                                        <div class="bg-white rounded-circle p-3 me-3">
                                            <i class="fas fa-shield-alt text-success fa-lg"></i>
                                        </div>
                                        <div>
                                            <h6 class="mb-1 fw-bold" style="color: #fff;">100% Secure</h6>
                                            <small style="color: rgba(255,255,255,0.9);">Protected data</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Terms and Conditions Modal -->
<div class="modal fade" id="termsModal" tabindex="-1" aria-labelledby="termsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header bg-success text-white">
                <h5 class="modal-title" id="termsModalLabel">
                    <i class="fas fa-file-contract me-2"></i>Terms and Conditions
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <h6 class="fw-bold text-success">1. Acceptance of Terms</h6>
                <p class="text-muted">By accessing and using SmartCrop, you agree to be bound by these Terms and Conditions. If you do not agree with any part of these terms, please do not use our service.</p>
                
                <h6 class="fw-bold text-success">2. Description of Service</h6>
                <p class="text-muted">SmartCrop provides AI-powered crop recommendation services based on soil parameters and environmental conditions. Our predictions are meant to assist farmers in making informed decisions but should not be the sole basis for agricultural planning.</p>
                
                <h6 class="fw-bold text-success">3. User Accounts</h6>
                <p class="text-muted">You are responsible for maintaining the confidentiality of your account credentials and for all activities that occur under your account. You agree to provide accurate and complete information when creating your account.</p>
                
                <h6 class="fw-bold text-success">4. Data Privacy</h6>
                <p class="text-muted">We respect your privacy and are committed to protecting your personal data. Your soil analysis data and prediction history are stored securely and are not shared with third parties without your consent.</p>
                
                <h6 class="fw-bold text-success">5. Accuracy of Predictions</h6>
                <p class="text-muted">While we strive to provide accurate crop recommendations using advanced machine learning algorithms, we cannot guarantee 100% accuracy. Predictions are based on the data you provide and historical agricultural data. Actual results may vary based on local conditions, farming practices, and other factors.</p>
                
                <h6 class="fw-bold text-success">6. Limitation of Liability</h6>
                <p class="text-muted">SmartCrop and its creators shall not be held liable for any damages, losses, or expenses resulting from the use of our service or reliance on our predictions. Users should always consult with local agricultural experts before making major farming decisions.</p>
                
                <h6 class="fw-bold text-success">7. Intellectual Property</h6>
                <p class="text-muted">All content, features, and functionality of SmartCrop are owned by us and are protected by international copyright, trademark, and other intellectual property laws.</p>
                
                <h6 class="fw-bold text-success">8. Changes to Terms</h6>
                <p class="text-muted">We reserve the right to modify these terms at any time. Users will be notified of significant changes. Continued use of the service after changes constitutes acceptance of the new terms.</p>
                
                <h6 class="fw-bold text-success">9. Contact</h6>
                <p class="text-muted">For any questions regarding these terms, please contact us through our support channels.</p>
                
                <div class="alert alert-success mt-4">
                    <i class="fas fa-info-circle me-2"></i>
                    <strong>Last Updated:</strong> December 2025
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" data-bs-dismiss="modal">
                    <i class="fas fa-check me-2"></i>I Understand
                </button>
            </div>
        </div>
    </div>
</div>

<script>
// Toggle password visibility
document.querySelectorAll('.toggle-password').forEach(button => {
    button.addEventListener('click', function() {
        const input = this.previousElementSibling;
        const icon = this.querySelector('i');
        if (input.type === 'password') {
            input.type = 'text';
            icon.classList.remove('fa-eye');
            icon.classList.add('fa-eye-slash');
        } else {
            input.type = 'password';
            icon.classList.remove('fa-eye-slash');
            icon.classList.add('fa-eye');
        }
    });
});

// Password strength indicator
document.getElementById('password').addEventListener('input', function() {
    const password = this.value;
    const strength = calculatePasswordStrength(password);
    const bar = document.getElementById('passwordStrength');
    const feedback = document.getElementById('passwordFeedback');
    
    bar.style.width = strength.percent + '%';
    bar.className = 'progress-bar ' + strength.class;
    feedback.textContent = strength.text;
    feedback.className = 'small ' + strength.textClass;
});

function calculatePasswordStrength(password) {
    let score = 0;
    if (password.length >= 8) score++;
    if (password.length >= 12) score++;
    if (/[a-z]/.test(password)) score++;
    if (/[A-Z]/.test(password)) score++;
    if (/[0-9]/.test(password)) score++;
    if (/[^a-zA-Z0-9]/.test(password)) score++;
    
    const levels = [
        { percent: 0, class: '', text: '', textClass: 'text-muted' },
        { percent: 16, class: 'bg-danger', text: 'Very weak', textClass: 'text-danger' },
        { percent: 33, class: 'bg-danger', text: 'Weak', textClass: 'text-danger' },
        { percent: 50, class: 'bg-warning', text: 'Medium', textClass: 'text-warning' },
        { percent: 66, class: 'bg-info', text: 'Good', textClass: 'text-info' },
        { percent: 83, class: 'bg-success', text: 'Strong', textClass: 'text-success' },
        { percent: 100, class: 'bg-success', text: 'Excellent', textClass: 'text-success' }
    ];
    
    return levels[Math.min(score, 6)];
}

// Password confirmation check
document.getElementById('confirm_password').addEventListener('input', function() {
    const password = document.getElementById('password').value;
    const confirm = this.value;
    const feedback = document.getElementById('confirmFeedback');
    
    if (confirm === '') {
        feedback.textContent = '';
    } else if (password === confirm) {
        feedback.textContent = '\u2713 Passwords match';
        feedback.className = 'small text-success';
    } else {
        feedback.textContent = '\u2717 Passwords do not match';
        feedback.className = 'small text-danger';
    }
});

// Form validation
document.getElementById('signupForm').addEventListener('submit', function(e) {
    const password = document.getElementById('password').value;
    const confirm = document.getElementById('confirm_password').value;
    
    if (password !== confirm) {
        e.preventDefault();
        alert('Passwords do not match!');
        return false;
    }
    
    // Loading state
    const btn = document.getElementById('signupBtn');
    btn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Creating account...';
    btn.disabled = true;
});
</script>

<style>
.min-vh-75 {
    min-height: 75vh;
}
.form-control:focus {
    border-color: #28a745;
    box-shadow: 0 0 0 0.25rem rgba(40, 167, 69, 0.25);
}
.btn-success {
    background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
    border: none;
}
.btn-success:hover {
    background: linear-gradient(135deg, #218838 0%, #1ea97c 100%);
    transform: translateY(-1px);
}
</style>
{% endblock %}
